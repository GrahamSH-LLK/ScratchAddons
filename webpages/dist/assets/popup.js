import{C as v,_ as I,o as p,c as l,a as i,m as w,t as m,F as h,l as g,D as P,q as x,k as _,w as b,v as k,E as y}from"./main2.js";import{_ as S}from"./popout.js";const L="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20aria-hidden='true'%20width='1em'%20height='1em'%20style='-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='m21.32%209.55-1.89-.63.89-1.78A1%201%200%200%200%2020.13%206L18%203.87a1%201%200%200%200-1.15-.19l-1.78.89-.63-1.89A1%201%200%200%200%2013.5%202h-3a1%201%200%200%200-.95.68l-.63%201.89-1.78-.89A1%201%200%200%200%206%203.87L3.87%206a1%201%200%200%200-.19%201.15l.89%201.78-1.89.63a1%201%200%200%200-.68.94v3a1%201%200%200%200%20.68.95l1.89.63-.89%201.78A1%201%200%200%200%203.87%2018L6%2020.13a1%201%200%200%200%201.15.19l1.78-.89.63%201.89a1%201%200%200%200%20.95.68h3a1%201%200%200%200%20.95-.68l.63-1.89%201.78.89a1%201%200%200%200%201.13-.19L20.13%2018a1%201%200%200%200%20.19-1.15l-.89-1.78%201.89-.63a1%201%200%200%200%20.68-.94v-3a1%201%200%200%200-.68-.95zM20%2012.78l-1.2.4A2%202%200%200%200%2017.64%2016l.57%201.14-1.1%201.1-1.11-.6a2%202%200%200%200-2.79%201.16l-.4%201.2h-1.59l-.4-1.2A2%202%200%200%200%208%2017.64l-1.14.57-1.1-1.1.6-1.11a2%202%200%200%200-1.16-2.82l-1.2-.4v-1.56l1.2-.4A2%202%200%200%200%206.36%208l-.57-1.11%201.1-1.1L8%206.36a2%202%200%200%200%202.82-1.16l.4-1.2h1.56l.4%201.2A2%202%200%200%200%2016%206.36l1.14-.57%201.1%201.1-.6%201.11a2%202%200%200%200%201.16%202.79l1.2.4zM12%208a4%204%200%201%200%204%204%204%204%200%200%200-4-4zm0%206a2%202%200%201%201%202-2%202%202%200%200%201-2%202z'%20fill='%23fff'/%3e%3c/svg%3e";v();function f(){if(!window.innerWidth||!window.innerHeight){setTimeout(f,0);return}let t=window.innerWidth;document.documentElement.style.setProperty("--width",`${t}px`);let n=window.innerHeight-3;document.documentElement.style.setProperty("--height",`${n}px`),document.body.classList.remove("loading")}window.addEventListener("load",()=>setTimeout(f,0));const M={data(){return{popups:[],currentPopup:null,popupsWithIframes:[]}},methods:{msg(t,...n){return chrome.i18n.getMessage(t,...n)},direction(){return chrome.i18n.getMessage("@@bidi_dir")},closePopup(){setTimeout(()=>window.close(),100)},openSettingsPage(){chrome.runtime.openOptionsPage(),this.closePopup()},setPopup(t){this.currentPopup!==t&&(this.currentPopup=t,chrome.storage.local.set({lastSelectedPopup:t._addonId}),this.popupsWithIframes.includes(t)||this.popupsWithIframes.push(t),setTimeout(()=>document.querySelector("iframe:not([style='display: none;'])").focus(),0))},iframeSrc(t){return this.popups.find(n=>n._addonId===t).html}},mounted(){let t=null;const n=["scratch-messaging","cloud-games","__settings__"];chrome.runtime.sendMessage("getSettingsInfo",a=>{t=a.manifests;const u=Object.keys(a.addonsEnabled).filter(s=>a.addonsEnabled[s]===!0).map(s=>t.find(e=>e.addonId===s)).filter(s=>s!==void 0).filter(({manifest:s})=>s.popup).sort(({addonId:s},{addonId:e})=>n.indexOf(s)-n.indexOf(e)).map(({addonId:s,manifest:e})=>(e.popup._addonId=s)&&Object.assign(e.popup,{html:`../../../popups/${s}/${e.popup.html}`}));u.push({name:chrome.i18n.getMessage("quickSettings"),icon:"../../images/icons/wrench.svg",html:"../../webpages/dist/index.html",_addonId:"__settings__"}),this.popups=u,chrome.storage.local.get("lastSelectedPopup",({lastSelectedPopup:s})=>{let e=-1;typeof s=="string"&&(e=this.popups.findIndex(o=>o._addonId===s)),e!==-1?this.setPopup(this.popups[e]):this.setPopup(this.popups.find(o=>o._addonId==="__settings__"))})}),chrome.runtime.onMessage.addListener((a,u,s)=>{if(a.changeEnabledState){const{addonId:e,newState:o}=a.changeEnabledState,{manifest:r}=t.find(d=>d.addonId===e);if(!r.popup)return;if(o===!0)r.popup._addonId=e,Object.assign(r.popup,{html:`../../../popups/${e}/${r.popup.html}`}),this.popups.push(r.popup),this.popups=this.popups.sort(({_addonId:d},{_addonId:c})=>n.indexOf(d)-n.indexOf(c));else{let d=this.popupsWithIframes.findIndex(c=>c._addonId===e);d!==-1&&this.popupsWithIframes.splice(d,1),d=this.popups.findIndex(c=>c._addonId===e),this.popups.splice(d,1),this.popups.includes(this.currentPopup)||this.setPopup(this.popups[0])}}})},computed:{changelogLink(){const t=chrome.i18n.getUILanguage(),n=t.startsWith("en")?"":`${t.split("-")[0]}/`,a=`utm_source=extension&utm_medium=popup&utm_campaign=v${chrome.runtime.getManifest().version}`;return`https://scratchaddons.com/${n}changelog/?${a}#v${chrome.runtime.getManifest().version}`},version(){const t=chrome.runtime.getManifest().version_name.includes("-prerelease"),n=chrome.runtime.getManifest().version;return t?n+"-pre":n}}};chrome.runtime.sendMessage("checkPermissions");const A={id:"header"},E={id:"title"},O=i("img",{src:P,id:"logo",alt:"Logo"},null,-1),W={id:"title-text"},T=["href","title"],C=["title"],z={id:"popups"},B={id:"popup-bar"},N={id:"popup-chooser"},$=["onClick"],j=["src"],D={class:"popup-title"},R=["href"],V=["title"],q=["src"];function F(t,n,a,u,s,e){return p(),l(h,null,[i("div",A,[i("div",E,[O,i("span",W,[w(m(e.msg("extensionName"))+" ",1),i("a",{id:"version",href:e.changelogLink,target:"_blank",title:e.msg("changelog")},"v"+m(e.version),9,T)])]),i("div",{class:"header-button",onClick:n[0]||(n[0]=o=>e.openSettingsPage())},[i("img",{src:L,id:"settings-icon",title:e.msg("settings")},null,8,C)])]),i("div",z,[i("div",B,[i("div",N,[(p(!0),l(h,null,g(s.popups,o=>(p(),l("div",{class:x(["popup-name",{sel:s.currentPopup===o}]),onClick:r=>e.setPopup(o)},[o.icon?(p(),l("img",{key:0,src:o.icon,class:"popup-icon"},null,8,j)):_("",!0),i("a",D,m(o.name),1),o.fullscreen?(p(),l("a",{key:1,class:"popout",href:`../../../popups/${o._addonId}/popup.html`,target:"_blank",onClick:n[1]||(n[1]=r=>e.closePopup())},[i("img",{src:S,class:"popout-img",title:e.msg("openInNewTab")},null,8,V)],8,R)):_("",!0)],10,$))),256))])]),(p(!0),l(h,null,g(s.popupsWithIframes,o=>b((p(),l("iframe",{src:e.iframeSrc(o._addonId),key:o._addonId},null,8,q)),[[k,s.currentPopup===o]])),128))])],64)}const H=I(M,[["render",F]]),U=y(H);U.mount("#app");
